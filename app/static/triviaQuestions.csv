question_id,question,query
1,"Which player who has played for the {teamA} and for the {teamB}.","SELECT playerName FROM player_team WHERE teamID IN (SELECT teamID FROM team WHERE teamName = '{teamA}') AND playerID IN (SELECT playerID FROM batting b JOIN teams t ON b.teamID = t.teamID WHERE t.teamID IN (SELECT teamID FROM teams WHERE team_name = '{teamB}'));"
2,"Which player had the highest batting average for the {team} in {yearID}?","SELECT playerID, (b_H / b_AB) AS batting_average FROM batting JOIN teams ON batting.teamID = teams.teamID WHERE teams.team_name = '{team}' AND batting.yearId = {yearID} AND b_AB > 0 ORDER BY batting_average DESC LIMIT 1;"
3,"Which player hit the most home runs for the {team} in {yearID}?","SELECT playerID, HR FROM batting JOIN teams ON batting.teamID = teams.teamID WHERE teams.team_name = '{team}' AND batting.yearID = {yearID} ORDER BY HR DESC LIMIT 1;"
4,"Which player had the most RBIs for the {team} in {yearID}?","SELECT playerID, b_RBI FROM batting JOIN teams ON batting.teamID = teams.teamID WHERE teams.team_name = '{team}' AND batting.yearID = {yearID} ORDER BY RBI DESC LIMIT 1;"
5,"Which player had the lowest ERA for the {team} in {yearID}","SELECT playerID, ROUND((p_ER / (p_IPOuts / 3.0)) * 9, 2) AS ERA FROM pitching WHERE teamID = '{teamID}' AND yearID = {yearID} AND p_IPOuts > 0 ORDER BY ERA ASC LIMIT 1;"
6,"Which player had the most stolen bases for the {team} in {yearID}?","SELECT playerID, b_SB FROM batting JOIN teams ON batting.teamID = teams.teamID WHERE teams.team_name = '{team}' AND batting.yearID = {yearID} ORDER BY SB DESC LIMIT 1;"
7,"Which player had the most home runs in a single season while playing for the {team}?","SELECT playerID, MAX(b_HR) AS max_home_runs FROM batting WHERE teamID = (SELECT teamID FROM teams WHERE team_name = '{team}') GROUP BY playerID ORDER BY max_home_runs DESC LIMIT 1;"
8,"Which player pitched for the {team} in {yearID} and also had more strikeouts than walks that season?","SELECT playerID, p_SO AS strikeouts, p_BB AS walks FROM pitching WHERE teamID = (SELECT teamID FROM teams WHERE team_name = '{team}') AND yearID = {yearID} AND p_SO > p_BB;"