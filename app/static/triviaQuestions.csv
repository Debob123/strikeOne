question_id,question,query
1,"Which player who has played for the {teamA} and for the {teamB}.","SELECT playerName FROM player_team WHERE teamID IN (SELECT teamID FROM team WHERE teamName = '{teamA}') AND playerID IN (SELECT playerID FROM batting b JOIN teams t ON b.teamID = t.teamID WHERE t.teamID IN (SELECT teamID FROM teams WHERE team_name = '{teamB}'));"
2,"Which player had the highest batting average for the {team} in {yearID}?","SELECT playerID, (b_H / b_AB) AS batting_average FROM batting JOIN teams ON batting.teamID = teams.teamID WHERE teams.team_name = '{team}' AND batting.yearId = {yearID} AND b_AB > 0 ORDER BY batting_average DESC LIMIT 1;"
3,"Which player hit the most home runs for the {team} in {yearID}?","SELECT playerID, HR FROM batting JOIN teams ON batting.teamID = teams.teamID WHERE teams.team_name = '{team}' AND batting.yearID = {yearID} ORDER BY HR DESC LIMIT 1;"
4,"Which player played for the {team} and won the {award}?","SELECT DISTINCT p.playerID FROM people p JOIN player_team pt ON p.playerID = pt.playerID JOIN awardsPlayers ap ON p.playerID = ap.playerID JOIN team t ON pt.teamID = t.teamID WHERE t.team_name = '{team}' AND ap.awardID = '{award}';"
