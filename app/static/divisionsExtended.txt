alter table divisions rename to divi;
DROP TABLE IF EXISTS `divisions`;
CREATE TABLE `divisions` (`divisions_ID` int(11) NOT NULL AUTO_INCREMENT,`divID` char(2) NOT NULL,`lgID` char(2) NOT NULL,`division_name` varchar(50) NOT NULL,`division_active` char(1) NOT NULL,`teamid` char(3) NOT NULL,`yearid` smallint(6) NOT NULL,`division_stint` smallint(6) NOT NULL DEFAULT 0, PRIMARY KEY (`divisions_ID`),UNIQUE KEY `unique_team_division` (`divID`,`lgID`,`teamid`,`yearid`,`division_stint`), KEY `lgID` (`lgID`),KEY `divisions_divID` (`divID`),CONSTRAINT `divisions_ibfk_1` FOREIGN KEY (`lgID`) REFERENCES `leagues` (`lgID`)) ;
INSERT INTO divisions (divID, lgid, division_name,division_active, teamid, yearid, division_stint) SELECT DISTINCT divid,lgid,division_name,division_active,teamid, yearid, 1 as division_stint FROM teams NATURAL JOIN divi WHERE yearid >= 1969 AND yearid = 1969;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1970;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1971;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1972;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1973;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1974;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1975;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1976;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1977;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1978;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1979;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1980;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1981;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1982;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1983;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1984;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1985;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1986;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1987;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1988;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1989;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1990;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1991;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1992;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1993;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1994;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1995;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1996;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1997;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1998;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 1999;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2000;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2001;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2002;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2003;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2004;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2005;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2006;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2007;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2008;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2009;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2010;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2011;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2012;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2013;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2014;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2015;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2016;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2017;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2018;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2019;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2020;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2021;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2022;
INSERT INTO divisions (divID, lgID, division_name, division_active, teamID, yearID, division_stint) SELECT DISTINCT divID, lgID, division_name, division_active, teamID, yearID, COALESCE((SELECT CASE divID WHEN (divID = t.divID) THEN division_stint + 1 ELSE division_stint END AS division_stint FROM divisions WHERE yearID = (t.yearID - 1) AND teamID = t.teamID), 1) AS division_stint FROM teams t NATURAL JOIN divi d WHERE yearid >= 1969 AND yearid = 2023;
drop table divi;